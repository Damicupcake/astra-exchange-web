{
	"rules": {
		"companies": {
			".read": "auth != null",
			"$uid": {
				".write": "$uid === auth.uid",
				"products": {
					"$productId": {
						"name": {
							".validate": "newData.isString() && newData.val() != ''"
						},
						"cost": {
							".validate": "newData.isNumber() && newData.val() > 0"
						},
						"inStock": {
							".validate": "newData.isBoolean()"
						}
					}
				}
			}
		},
		"transactions": {
			"$uid": {
				".read": "$uid === auth.uid",
				".write": "$uid === auth.uid",
				"$transactionId": {
					".write": "!data.exists()",
					"time": {
						".validate": "newData.isString()"
					},
					"from": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"to": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
		  			"amount": {
						".validate": "newData.isNumber() && newData.val() > 0 && newData.val() <= root.child('users/' + $uid + '/balance').val()"
					},
					"balance": {
						".validate": "newData.isNumber() && newData.val() >= 0"
					},
					"message": {
						".validate": "newData.isString()"
					}
				}
			}
		},
		"invoices": {
			"$uid": {
				".read": "$uid === auth.uid",
				".write": "auth != null",
				"$invoiceId": {
					"time": {
						".validate": "newData.isString()"
					},
					"status": {
						".validate": "newData.val() === 'pending' || newData.val() === 'declined' || newData.val() === 'accepted'"
					},
					"from": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"to": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"amount": {
						".validate": "newData.isNumber() && newData.val() > 0"
					},
					"message": {
						".validate": "newData.isString()"
					}
				}
			}
		},
		"users": {
			".read": true,
			".write": true,
			"$uid": {
				".write": "!data.exists()",
				"name": {
					".validate": "newData.isString() && newData.val() != ''"
				},
				"email": {
					".validate": "newData.isString() && newData.val() != ''"
				},
				"balance": {
					".validate": "newData.val() === 0"
				},
				"pin": {
					".validate": "newData.isNumber() && newData.val().length === 4"
				}
			}
		}
	}
}