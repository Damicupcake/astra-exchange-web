{
	"rules": {
		"bazaarData": {
			".read": true
		},
		"pvHist": {
			".read": true,
			".write": true
		},
		"companies": {
      		".read": true,
			"$uid": {
				".write": "$uid === auth.uid",
				"products": {
					"$productId": {
						"name": {
							".validate": "newData.isString() && newData.val() != ''"
						},
						"cost": {
							".validate": "newData.isNumber() && newData.val() > 0"
						},
						"inStock": {
							".validate": "newData.isBoolean()"
						}
					}
				}
			}
		},
		"transactions": {
			"$uid": {
				".read": "$uid === auth.uid || root.child('users/' + auth.uid + '/cards/' + $uid).exists()",
				".write": "$uid === auth.uid || root.child('cards/' + $uid).exists()",
				"$transactionId": {
					".write": "!data.exists()",
					"time": {
						".validate": "newData.isString() && newData.val() != ''"
					},
					"from": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"to": {
						".validate": "newData.isString() && newData.val() != $uid && root.child('users/' + newData.val()).exists()"
					},
		  			"amount": {
						".validate": "(newData.isNumber() && ((newData.val() > 0 && newData.val() <= root.child('users/' + $uid + '/balance').val()) || auth.uid === 'h621pgey1vPfxrmoW5LUkZaHkhT2')) || (newData.isString() && newData.val().length === 2 && auth.uid === 'h621pgey1vPfxrmoW5LUkZaHkhT2')"
					},
					"balance": {
						".validate": "newData.isNumber() && newData.val() >= 0"
					},
					"message": {
						".validate": "newData.isString()"
					}
				}
			}
		},
		"pending": {
			"$pendingId": {
				".read": true,
				".write": "!data.exists()",
				"time": {
					".validate": "newData.isString() && newData.val() != ''"
				},
				"from": {
					".validate": "newData.isString() && root.child('cards/' + newData.val()).exists()"
				},
				"to": {
					".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
				},
				"amount": {
					".validate": "newData.isNumber() && newData.val() > 0"
				},
				"balance": {
					".validate": "newData.isNumber() && newData.val() >= 0"
				},
				"pin": {
					".validate": "newData.isString() && newData.val().length === 4"
				}
			}
		},
		"invoices": {
			"$uid": {
				".read": "$uid === auth.uid",
				".write": "auth != null",
				"$invoiceId": {
					"time": {
						".validate": "newData.isString() && newData.val() != ''"
					},
					"status": {
						".validate": "newData.val() === 'pending' || newData.val() === 'declined' || newData.val() === 'accepted'"
					},
					"from": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"to": {
						".validate": "newData.isString() && root.child('users/' + newData.val()).exists()"
					},
					"amount": {
						".validate": "newData.isNumber() && newData.val() > 0"
					},
					"message": {
						".validate": "newData.isString()"
					}
				}
			}
		},
		"cards": {
			"$cardId": {
				".read": "data.val() === auth.uid"
			}
		},
		"users": {
      	".read": true,
			"$uid": {
				".write": "!data.exists()",
				"name": {
					".validate": "newData.isString() && newData.val() != ''"
				},
				"email": {
					".validate": "newData.isString() && newData.val() != ''"
				},
				"balance": {
					".validate": "newData.val() === 0"
				},
				"independence": {
					".read": "$uid === auth.uid"
				},
				"pin": {
					".read": "$uid === auth.uid"
				},
				"cards": {
					".read": "$uid === auth.uid",
					"$cardId": {
						"name": {
							".validate": "newData.isString() && newData.val() != ''"
						},
						"pin": {
							".validate": "newData.isString() && newData.val().length === 4"
						}
					}
				}
			}
		}
	}
}